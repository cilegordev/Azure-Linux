--- a/libiberty/simple-object-elf.c
+++ b/libiberty/simple-object-elf.c
@@ -548,6 +548,14 @@
       XDELETE (eor);
       return NULL;
     }
+  
+  if (!eor->shstrndx)
+    {
+      *errmsg = "invalid ELF shstrndx == 0";
+      *err = 0;
+      XDELETE (eor);
+      return NULL;
+    }
 
   return (void *) eor;
 }
